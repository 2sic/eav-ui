<div class="eav-dialog eav-no-scrollbar">
  <div class="eav-dialog-header">
    <div class="eav-dialog-header__title">
      {{ title | translate }}
    </div>
    <button mat-icon-button tippy="Close dialog" (click)="dialog.close()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div class="eav-dialog-content">
    @switch (initialState) {
      @case (sharingOrInheriting.Sharing)  {
        <div>{{ message | translate }} {{ dialogData.Guid }}</div>
      }
      @case (sharingOrInheriting.Inheriting)  {
        <div>{{ message | translate }} {{ dialogData.SysSettings.InheritMetadataOf }}</div>
      }
      @case (sharingOrInheriting.None) {
        <p>
          This field is currently not shared or inherited.
          You can choose to:
        </p>
        <ul>
          <li>Make it public (<strong>share</strong>) so it can be re-used by other Content Types</li>
          <li>Change it to <strong>inherit</strong> it's definition from another previously shared field</li>
        </ul>
        <br>
        <div>
          @if (state == sharingOrInheriting.None) {
            <button mat-raised-button type="button" class="eav-dialog-action-button" (click)="chooseShare()">
              Share
            </button>
          }
          @if (state == sharingOrInheriting.None) {
            <button mat-raised-button type="button" (click)="chooseInherit()">
              Inherit
            </button>
          }
          @if (state == sharingOrInheriting.Sharing) {
            <span>This will share the field definition</span>
          }
          @if (state == sharingOrInheriting.Inheriting) {
            <mat-card class="eav-table-div">
              <table mat-table [dataSource]="shareableFields()" class="mat-elevation-z8 eav-fields-table">
                <ng-container matColumnDef="contentType">
                  <th mat-header-cell *matHeaderCellDef> <b>Content Type</b> </th>
                  <td mat-cell *matCellDef="let field"> {{field.ContentType.Name}} </td>
                </ng-container>
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef> <b>Name</b> </th>
                  <td mat-cell *matCellDef="let field"> {{field.StaticName}} </td>
                </ng-container>
                <ng-container matColumnDef="type">
                  <th mat-header-cell *matHeaderCellDef> <b>Type</b> </th>
                  <td mat-cell *matCellDef="let field"> {{field.Type}} </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedShareableFieldsColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedShareableFieldsColumns;"
                [ngClass]="{'eav-selected-row': guid === row.Guid}" (click)="inheritField(row)"></tr>
              </table>
            </mat-card>
          }
        </div>  
      }
    }
    <!-- @if (initialState == sharingOrInheriting.Sharing) {
      <div>{{ message | translate }} {{ dialogData.Guid }}</div>
    } -->
    <!-- @if (initialState == sharingOrInheriting.Inheriting) {
      <div>{{ message | translate }} {{
      dialogData.SysSettings.InheritMetadataOf }}</div>
    } -->
    <!-- @if (initialState == sharingOrInheriting.None) {
      <div>
        @if (state == sharingOrInheriting.None) {
          <button mat-raised-button type="button" class="eav-dialog-action-button"
          (click)="chooseShare()">Share</button>
        }
        @if (state == sharingOrInheriting.None) {
          <button mat-raised-button type="button"
          (click)="chooseInherit()">Inherit</button>
        }
        @if (state == sharingOrInheriting.Sharing) {
          <span>This will share the field definition</span>
        }
        @if (state == sharingOrInheriting.Inheriting) {
          <mat-card class="eav-table-div">
            <table mat-table [dataSource]="shareableFields()" class="mat-elevation-z8 eav-fields-table">
              <ng-container matColumnDef="contentType">
                <th mat-header-cell *matHeaderCellDef> <b>Content Type</b> </th>
                <td mat-cell *matCellDef="let field"> {{field.ContentType.Name}} </td>
              </ng-container>
              <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef> <b>Name</b> </th>
                <td mat-cell *matCellDef="let field"> {{field.StaticName}} </td>
              </ng-container>
              <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef> <b>Type</b> </th>
                <td mat-cell *matCellDef="let field"> {{field.Type}} </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="displayedShareableFieldsColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedShareableFieldsColumns;"
              [ngClass]="{'eav-selected-row': guid === row.Guid}" (click)="inheritField(row)"></tr>
            </table>
          </mat-card>
        }
      </div>
    } -->
  </div>
  <!-- If not inheriting yet, show cancel/save buttons -->
  <!-- <app-feature-icon-text class="eav-button-feature-icon" [featureNameId]="'ContentTypeFieldsReuseDefinitions'"></app-feature-icon-text> -->

  <app-feature-text-info class="eav-button-feature" [featureNameId]="'ContentTypeFieldsReuseDefinitions'"></app-feature-text-info>

  @if (initialState == sharingOrInheriting.None) {
    <div class="eav-dialog-actions-custom">
      <button mat-raised-button type="button" class="eav-dialog-action-button" (click)="dialog.close()">Cancel</button>
      <button mat-raised-button type="submit" color="accent" class="eav-dialog-action-button" (click)="save()">
        <div class="eav-button-feature">
          <span>Save</span>
          <!-- <app-feature-icon-indicator class="eav-button-feature-icon" [featureNameId]="'ContentTypeFieldsReuseDefinitions'"></app-feature-icon-indicator> -->
        </div>
      </button>
    </div>
  }
</div>
