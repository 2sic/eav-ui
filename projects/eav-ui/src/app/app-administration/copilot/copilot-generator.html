<div style="display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 0 16px">
  <h3 class="mat-subtitle-1">Configurations ({{ (entities$ | async)?.length || 0 }})</h3>
  <button mat-fab mat-elevation-z24 class="grid-fab" tippy="Add Configuration" tippyPlacement="left" (click)="editConfig()">
    <mat-icon>add</mat-icon>
  </button>
</div>

@if (entities$ | async; as entities) { @if (entities.length === 0) {
<p class="mat-body-1">No configurations yet. Click + to create one.</p>
} @else {
<div style="padding: 0 16px">
  <ag-grid-angular
    class="ag-theme-material"
    style="width: 100%"
    [rowData]="dataSourceData()"
    [gridOptions]="gridOptions"
    domLayout="autoHeight"
  ></ag-grid-angular>
</div>
} }

<div style="max-width: 400px; margin-top: 24px; margin-left: 16px">
  <mat-card>
    <mat-card-content>
      <h3 class="mat-subtitle-1">Quick Generate</h3>
      <br />

      <div style="max-width: 400px">
        <mat-form-field color="accent" class="eav-mat-form-field">
          <mat-label>Generator</mat-label>
          <mat-select required [(value)]="selectedGeneratorName">
            <mat-select-trigger> {{ selectedGeneratorName() }} </mat-select-trigger>
            @for (generator of generators().sort(); track generator) {
            <mat-option [value]="generator.name">
              <strong>{{ generator.name }} v{{ generator.version }}</strong><br />
              {{ generator.description }}
            </mat-option>
            }
          </mat-select>
          @if (selectedGenerator(); as selectedGenerator) {
            <ng-container>
              <mat-hint [innerHTML]="selectedGenerator.descriptionHtml"></mat-hint>
            </ng-container>
          }
        </mat-form-field>
        
        <br />

        @if (editions(); as editions) {
        <mat-form-field color="accent" class="eav-mat-form-field">
          <mat-label>Select an Edition to generate code for</mat-label>
          <mat-select required [(value)]="selectedEdition">
            @for (edition of editions.sort(); track edition) {
            <mat-option [value]="edition.name"> <strong>{{ edition.label }}</strong> ({{ edition.description }}) </mat-option>
            }
          </mat-select>
          <mat-hint>
            Editions are managed in the <code>/App_Data/app.json</code> file. See
            <a href="https://go.2sxc.org/app-json" target="_blank">docs</a>.
          </mat-hint>
        </mat-form-field>
        }

        <br />
        <div style="display: flex; justify-content: flex-end">
          <button mat-button class="eav-button__with-icon" (click)="autoGeneratedCode()">
            <mat-icon class="eav-icon">code</mat-icon>
            <span>Generate Code</span>
          </button>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>

<router-outlet></router-outlet>
