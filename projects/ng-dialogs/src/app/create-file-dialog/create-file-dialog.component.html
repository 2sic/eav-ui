<ng-container *ngIf="templateVars$ | async as data">
  <div mat-dialog-title>
    <div class="dialog-title-box hide-scrollbar">
      <span>Create</span>
      <span class="file-name">{{
        controls.finalName.value
        || (controls.folder.value ? controls.folder.value.trim() + '/' : '')
        }}</span>
    </div>
  </div>

  <form [formGroup]="form" class="dialog-form">
    <div class="dialog-form-content fancy-scrollbar-light">

      <div class="field-container multiple">
        <!-- Platform -->
        <div class="multiple-field">
          <mat-form-field appearance="standard" color="accent">
            <mat-label>Platform</mat-label>
            <mat-select formControlName="platform">
              <mat-option [value]="all">All</mat-option>
              <mat-option *ngFor="let platform of data.platforms" [value]="platform">
                {{ platform }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Purpose -->
        <div class="multiple-field">
          <mat-form-field appearance="standard" color="accent">
            <mat-label>Purpose</mat-label>
            <mat-select formControlName="purpose">
              <mat-option [value]="all">All</mat-option>
              <mat-option *ngFor="let purpose of data.purposes" [value]="purpose">
                {{ purpose }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <!-- Template -->
      <div class="field-container">
        <mat-form-field appearance="standard" color="accent">
          <mat-label>Template</mat-label>
          <mat-select formControlName="templateKey">
            <mat-option [value]="noTemplate">No template</mat-option>
            <mat-option *ngFor="let template of data.templates" [value]="template.Key">
              {{ template.Name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Name -->
      <div class="field-container">
        <mat-form-field appearance="standard" color="accent">
          <mat-label>Name</mat-label>
          <input matInput type="text" formControlName="name" required>
        </mat-form-field>
        <app-field-hint *ngIf="controls.name.touched && controls.name.errors?.required" [isError]="true">
          This field is required
        </app-field-hint>
      </div>
    </div>

    <div class="dialog-form-actions">
      <button mat-raised-button type="button" (click)="closeDialog()">Cancel</button>
      <button mat-raised-button type="button" color="accent" [disabled]="!form.valid" (click)="confirm()">
        Create
      </button>
    </div>

    <ng-container *ngIf="data.preview">
      <div class="preview-label-box">
        <label class="preview-label">Preview</label>
      </div>
      <pre class="fancy-scrollbar-light">{{ data.preview }}</pre>
    </ng-container>
  </form>
</ng-container>
